---
import BaseHead from "../components/BaseHead.astro";
import Footer from "../components/Footer.astro";
import Header from "../components/Header.astro";
import FormattedDate from "../components/FormattedDate.astro";
import LazyImage from "../components/LazyImage.astro";
import Route2026 from "../components/Route2026.astro";
import ManifestoPillars from "../components/ManifestoPillars.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../consts";
import { getCollection } from "astro:content";
import { getImgproxyUrl } from "../utils/imgproxy";

// Schema.org structured data
const site = Astro.site || Astro.url.origin;
const schema = {
	"@context": "https://schema.org",
	"@type": "Person",
	name: "Lucio Torres",
	url: site,
	sameAs: [
		"https://twitter.com/luciotorres",
		"https://www.linkedin.com/in/luciotorres",
	],
	image: `${site}/lucio.png`,
	jobTitle: "Precandidato Presidencial 2026",
	description:
		"Periodista independiente y defensor del pueblo, candidato por una Colombia justa y soberana.",
};

const allPosts = (await getCollection("articulos")).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
const recentPosts = allPosts.slice(0, 3);

function extractSlugFromPath(id: string): string {
	const parts = id.split("/");
	return parts[parts.length - 1];
}
---

<!doctype html>
<html lang="es" data-theme="colombia">
	<head>
		<BaseHead
			title={SITE_TITLE}
			description={SITE_DESCRIPTION}
			image={{
				src: "/lucio.png",
				width: 1200,
				height: 630,
				format: "png",
			}}
			schema={schema}
		/>
	</head>
	<body class="bg-base-100 text-base-content font-sans antialiased">
		<div class="flag-separator sticky top-0 z-50 shadow-md">
			<div class="y"></div>
			<div class="b"></div>
			<div class="r"></div>
		</div>
		<Header />

		<main id="main-content">
			<!-- HERO SECTION -->
			<section
				class="hero min-h-screen bg-base-100 relative overflow-hidden pt-20"
			>
				<div
					class="hero-content flex-col lg:flex-row-reverse gap-20 max-w-screen-2xl px-6 lg:px-12"
				>
					<div class="relative lg:w-1/2 flex justify-center">
						<div
							class="absolute inset-0 bg-primary/20 rounded-full blur-[120px] scale-150"
						>
						</div>
						<img
							src="/lucio.png"
							alt="Lucio Torres"
							class="max-w-xs md:max-w-lg grayscale hover:grayscale-0 transition-all duration-1000 relative z-10"
						/>
					</div>

					<div class="lg:w-1/2 text-center lg:text-left z-10">
						<div
							class="inline-flex items-center gap-4 mb-12 bg-base-200/50 px-6 py-2 rounded-full border border-base-300"
						>
							<span
								class="w-3 h-3 rounded-full bg-accent animate-pulse"
							></span>
							<span
								class="text-xs font-black uppercase tracking-[0.2em] text-secondary"
								>Candidato Presidencial 2026</span
							>
						</div>

						<h1
							class="text-[clamp(3.5rem,15vw,10rem)] font-editorial font-black leading-[0.8] mb-8 md:mb-12 text-base-content"
						>
							LUCIO <br />
							<span class="text-secondary">TORRES.</span>
						</h1>

						<p
							class="text-4xl md:text-5xl font-editorial font-bold mb-12 text-base-content/90 leading-tight"
						>
							"Pan con Paz: El <span
								class="text-highlight text-base-content"
								>compromiso sagrado</span
							> con nuestra tierra."
						</p>

						<div
							class="flex flex-wrap gap-6 justify-center lg:justify-start"
						>
							<a href="#ruta" class="btn-hero-primary">
								Ruta 2026
							</a>
							<a href="/gran-colombia" class="btn-hero-secondary">
								Propuesta
							</a>
						</div>

						<!-- Stats Grid - Colombia Theme -->
						<div
							class="grid grid-cols-3 gap-12 mt-24 pt-12 border-t border-base-300 max-w-lg mx-auto lg:mx-0"
						>
							<div>
								<div
									class="text-5xl font-editorial font-black text-secondary"
								>
									100%
								</div>
								<div
									class="text-[10px] uppercase tracking-[0.2em] font-bold text-base-content/50 mt-2"
								>
									Independiente
								</div>
							</div>
							<div>
								<div
									class="text-5xl font-editorial font-black text-primary drop-shadow-sm"
									style="text-shadow: 1px 1px 0 #000;"
								>
									45+
								</div>
								<div
									class="text-[10px] uppercase tracking-[0.2em] font-bold text-base-content/50 mt-2"
								>
									Años Verdad
								</div>
							</div>
							<div>
								<div
									class="text-5xl font-editorial font-black text-accent"
								>
									0
								</div>
								<div
									class="text-[10px] uppercase tracking-[0.2em] font-bold text-base-content/50 mt-2"
								>
									Maquinarias
								</div>
							</div>
						</div>
					</div>
				</div>
			</section>

			<!-- FEATURED NEWS GRID -->
			<section
				class="py-32 bg-base-200/50 px-6 lg:px-12 border-t border-base-300"
			>
				<div class="max-w-screen-2xl mx-auto">
					<div
						class="flex flex-col md:flex-row justify-between items-end mb-24 gap-12"
					>
						<div>
							<div class="flex items-center gap-4 mb-6">
								<div class="w-3 h-3 bg-accent"></div>
								<span
									class="text-xs font-black uppercase tracking-[0.4em] text-neutral/60"
									>ARCHIVO DE VERDAD</span
								>
							</div>
							<h2
								class="text-4xl sm:text-6xl md:text-8xl font-editorial font-black text-neutral uppercase tracking-tighter leading-none"
							>
								INVESTIGACIONES <br />
								<span class="text-accent">DE PODER.</span>
							</h2>
						</div>
						<a
							href="/articulos"
							class="btn btn-link text-neutral font-black uppercase tracking-widest no-underline border-b-2 border-primary group"
						>
							ARCHIVO COMPLETO
							<svg
								xmlns="http://www.w3.org/2000/svg"
								class="h-5 w-5 transition-transform group-hover:translate-x-2"
								fill="none"
								viewBox="0 0 24 24"
								stroke="currentColor"
							>
								<path
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="3"
									d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
							</svg>
						</a>
					</div>

					<div
						class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-12"
					>
						{
							recentPosts.map((post) => (
								<article class="bg-white border border-base-300 group transition-all duration-500 hover:shadow-2xl">
									<figure class="aspect-4/3 overflow-hidden relative grayscale hover:grayscale-0 transition-all duration-700">
										<div class="absolute top-0 left-0 z-20 bg-primary px-4 py-2">
											<span class="text-[10px] font-black uppercase tracking-widest text-neutral">
												{post.data.categories?.[0] ||
													"Investigación"}
											</span>
										</div>
										{post.data.heroImage ? (
											<img
												src={getImgproxyUrl(
													post.data.heroImage,
													600,
													450,
												)}
												alt={post.data.title}
												class="w-full h-full object-cover transition-transform duration-1000 group-hover:scale-110"
											/>
										) : (
											<div class="w-full h-full bg-base-200 flex items-center justify-center">
												<svg
													xmlns="http://www.w3.org/2000/svg"
													class="h-16 w-16 opacity-5"
													fill="none"
													viewBox="0 0 24 24"
													stroke="currentColor"
												>
													<path
														stroke-linecap="round"
														stroke-linejoin="round"
														stroke-width="1"
														d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
													/>
												</svg>
											</div>
										)}
									</figure>
									<div class="p-10">
										<div class="text-[10px] font-black opacity-40 mb-4 tracking-[0.2em]">
											<FormattedDate
												date={post.data.pubDate}
											/>
										</div>
										<h3 class="text-3xl font-editorial font-black mb-6 leading-tight group-hover:text-secondary transition-colors">
											<a
												href={`/articulos/${extractSlugFromPath(post.id)}/`}
											>
												{post.data.title}
											</a>
										</h3>
										<p class="text-neutral/60 line-clamp-3 mb-8 text-lg leading-relaxed font-medium italic">
											{post.data.description}
										</p>
										<a
											href={`/articulos/${extractSlugFromPath(post.id)}/`}
											class="text-xs font-black uppercase tracking-widest text-accent border-b-2 border-transparent hover:border-accent transition-all pb-1"
										>
											VER EVIDENCIAS →
										</a>
									</div>
								</article>
							))
						}
					</div>
				</div>
			</section>

			<!-- ROUTE 2026 SECTION -->
			<Route2026 />

			<!-- MANIFIESTO SECTION -->
			<ManifestoPillars />

			<!-- CTA SECTION -->
			<section
				class="py-40 bg-neutral text-white text-center relative px-6 overflow-hidden"
			>
				<div
					class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/graphy.png')]"
				>
				</div>

				<div class="max-w-5xl mx-auto relative z-10">
					<h2
						class="text-5xl sm:text-7xl md:text-[10rem] font-editorial font-black mb-12 uppercase tracking-tighter leading-none"
					>
						ÚNETE A LA <br />
						<span class="text-primary italic text-highlight"
							>RUTA.</span
						>
					</h2>
					<p
						class="text-3xl md:text-4xl text-white/70 mb-20 font-editorial font-bold max-w-3xl mx-auto leading-tight italic"
					>
						"El cambio real no se pide, se construye con la verdad
						en la mano y el pueblo en el corazón."
					</p>

					<div class="flex flex-wrap gap-8 justify-center mb-32">
						<button
							class="btn-hero-primary text-xl px-16 border-none text-secondary"
						>
							SER VOLUNTARIO
						</button>
						<button
							class="btn btn-outline border-2 border-white text-white px-16 py-4 rounded-full font-black uppercase tracking-widest hover:bg-white hover:text-neutral transition-all duration-500"
						>
							QUIERO VOTAR
						</button>
					</div>

					<div
						class="max-w-xl mx-auto bg-white/5 p-1 rounded-none border border-white/10"
						x-data="{ email: '', submitted: false }"
					>
						<div class="join w-full" x-show="!submitted">
							<input
								class="input join-item w-full bg-transparent border-none focus:outline-none text-white placeholder:text-white/30 text-xl font-medium px-8"
								placeholder="Tu correo de contacto"
								x-model="email"
							/>
							<button
								class="btn btn-primary join-item px-12 bg-primary border-none text-neutral font-black uppercase tracking-widest hover:bg-white transition-colors"
								@click="if(email) submitted = true"
							>
								SUMARME
							</button>
						</div>
						<div
							class="py-10 px-12 text-primary font-black text-2xl uppercase tracking-widest flex items-center justify-center gap-4"
							x-show="submitted"
							x-cloak
							x-transition
						>
							<svg
								xmlns="http://www.w3.org/2000/svg"
								class="h-10 w-10"
								fill="none"
								viewBox="0 0 24 24"
								stroke="currentColor"
							>
								<path
									stroke-linecap="round"
									stroke-linejoin="round"
									stroke-width="3"
									d="M5 13l4 4L19 7"></path>
							</svg>
							BIENVENIDO A LA RUTA
						</div>
					</div>
				</div>
			</section>
		</main>

		<Footer />
	</body>
</html>
