---
import type { CollectionEntry } from "astro:content";
import BaseHead from "../components/BaseHead.astro";
import Footer from "../components/Footer.astro";
import FormattedDate from "../components/FormattedDate.astro";
import Header from "../components/Header.astro";
import LazyImage from "../components/LazyImage.astro";
import ReadingProgress from "../components/ReadingProgress.astro";
import ShareButtons from "../components/ShareButtons.astro";
import AuthorCard from "../components/AuthorCard.astro";
import FallbackImage from "../assets/blog-placeholder-1.jpg";

type Props = CollectionEntry<"articulos">["data"];

const {
    title,
    description,
    pubDate,
    updatedDate,
    heroImage,
    heroImageAlt,
    categories,
    tags,
    author,
} = Astro.props;
---

<html lang="es">
    <head>
        <BaseHead
            title={title}
            description={description || "Análisis político y periodístico"}
            image={heroImage || FallbackImage}
        />
        <style>
            /* ── Design C: Impacto Article Layout ── */
            .article-layout {
                background: var(--bg);
                min-height: 100vh;
            }

            /* ── Header / Hero Section ── */
            .article-header-wrapper {
                background: var(--gradient-hero);
                padding: 10rem 1.5rem 8rem; /* Large bottom padding for overlap */
                text-align: center;
                position: relative;
                color: #fff;
                overflow: hidden;
            }
            .article-header-wrapper::before {
                content: "";
                position: absolute;
                inset: 0;
                background: radial-gradient(
                    circle at 50% 30%,
                    rgba(245, 158, 11, 0.15) 0%,
                    transparent 60%
                );
            }

            .article-header {
                max-width: 900px;
                margin: 0 auto;
                position: relative;
                z-index: 2;
            }

            /* Categories */
            .article-categories {
                display: flex;
                gap: 0.6rem;
                justify-content: center;
                flex-wrap: wrap;
                margin-bottom: 2rem;
            }
            .article-categories span {
                display: inline-block;
                background: rgba(255, 255, 255, 0.1);
                color: var(--colombia-gold);
                padding: 0.4rem 1.2rem;
                border: 1px solid rgba(245, 158, 11, 0.3);
                border-radius: 100px;
                font-size: 0.75rem;
                font-weight: 700;
                letter-spacing: 0.1em;
                text-transform: uppercase;
                backdrop-filter: blur(4px);
            }

            /* Title */
            .article-header h1 {
                font-family: var(--font-heading);
                font-size: clamp(2.5rem, 6vw, 4.5rem);
                font-weight: 400;
                line-height: 1.05;
                letter-spacing: -0.01em;
                color: #fff;
                margin: 0 0 2rem;
            }

            /* Meta */
            .article-meta {
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 1.5rem;
                flex-wrap: wrap;
                font-size: 0.95rem;
                color: rgba(255, 255, 255, 0.7);
            }
            .article-meta__author {
                font-weight: 700;
                color: #fff;
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }
            .article-meta__separator {
                width: 4px;
                height: 4px;
                border-radius: 50%;
                background: rgba(255, 255, 255, 0.3);
            }

            /* ── Hero Image (Overlapping) ── */
            .article-hero {
                max-width: 1000px;
                margin: -5rem auto 0; /* Negative margin for overlap */
                padding: 0 1.5rem;
                position: relative;
                z-index: 10;
            }
            .article-hero :global(img) {
                border-radius: 20px;
                box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
                border: 4px solid rgba(255, 255, 255, 0.1);
            }

            /* ── Body ── */
            .article-container {
                max-width: 720px;
                margin: 0 auto;
                padding: 4rem 1.5rem 0;
            }

            .article-body {
                position: relative;
            }

            /* ── Tags ── */
            .article-tags {
                margin: 4rem 0;
                padding-top: 2rem;
                display: flex;
                gap: 0.6rem;
                flex-wrap: wrap;
                border-top: 1px solid var(--border);
            }
            .article-tags span {
                display: inline-block;
                color: var(--text-muted);
                padding: 0.5rem 1rem;
                border: 1px solid var(--border);
                border-radius: 50px;
                font-size: 0.85rem;
                transition: all 0.2s ease;
                font-weight: 500;
            }
            .article-tags span:hover {
                border-color: var(--colombia-gold);
                color: var(--colombia-gold);
                background: rgba(245, 158, 11, 0.05);
            }

            /* ── Author Section ── */
            .article-author-section {
                margin-bottom: 4rem;
            }

            /* ── Responsive ── */
            @media (max-width: 768px) {
                .article-header-wrapper {
                    padding: 8rem 1rem 6rem;
                }
                .article-hero {
                    margin-top: -3rem;
                    padding: 0 1rem;
                }
                .article-container {
                    padding-top: 3rem;
                }
                .article-header h1 {
                    font-size: 2.5rem;
                }
                .article-meta {
                    gap: 1rem;
                    font-size: 0.85rem;
                }
            }
        </style>
    </head>

    <body>
        <ReadingProgress />
        <Header />

        <main class="article-layout">
            <article>
                {/* Header Wrapper with Dark Background */}
                <div class="article-header-wrapper">
                    <header class="article-header">
                        {
                            categories && categories.length > 0 && (
                                <div class="article-categories">
                                    {categories.map((cat) => (
                                        <span>{cat}</span>
                                    ))}
                                </div>
                            )
                        }

                        <h1>{title}</h1>

                        <div class="article-meta">
                            <span class="article-meta__author">
                                Por {author || "Lucio Torres"}
                            </span>
                            <span class="article-meta__separator"></span>
                            <FormattedDate date={pubDate} />
                            {
                                updatedDate && (
                                    <>
                                        <span class="article-meta__separator" />
                                        <span class="article-meta__updated">
                                            Actualizado:{" "}
                                            <FormattedDate date={updatedDate} />
                                        </span>
                                    </>
                                )
                            }
                        </div>
                    </header>
                </div>

                {/* Hero Image - Overlapping */}
                {
                    heroImage && (
                        <div class="article-hero">
                            <LazyImage
                                src={heroImage}
                                alt={heroImageAlt || title}
                                width={1000}
                                height={560}
                                aspectRatio="16/9"
                                priority={true}
                            />
                        </div>
                    )
                }

                {/* Article Content */}
                <div class="article-container">
                    <div class="article-body article-prose">
                        <slot />
                    </div>

                    {/* Tags */}
                    {
                        tags && tags.length > 0 && (
                            <div class="article-tags">
                                {tags.map((tag) => (
                                    <span>#{tag}</span>
                                ))}
                            </div>
                        )
                    }

                    {/* Author Card */}
                    <div class="article-author-section">
                        <AuthorCard author={author || "Lucio Torres"} />
                    </div>

                    {/* Share Buttons */}
                    <div
                        style="display: flex; justify-content: center; margin-bottom: 4rem;"
                    >
                        <ShareButtons title={title} />
                    </div>
                </div>
            </article>
        </main>

        <Footer />
        <script
            async
            src="https://platform.twitter.com/widgets.js"
            charset="utf-8"></script>
    </body>
</html>
